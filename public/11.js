webpackJsonp([11],{"+H9S":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{class:this.$store.state.showSidebar?"content-title":"spacer content-title"},[s("h4",{staticClass:"module-title"},[t._v("PURCHASE ORDER")]),t._v(" "),s("hr",{staticClass:"title-border"})]),t._v(" "),s("div",{staticClass:"p-md-4"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header"},[s("a",{staticClass:"text-success",attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.viewPOs(e)}}},[t._v("Purchase Orders")]),t._v(" "),s("a",{staticClass:"text-secondary"},[t._v(" / Create New Purchase Order")])]),t._v(" "),s("div",{staticClass:"card-body"},[t.ifReady?s("div",[s("form",{on:{submit:function(e){return e.preventDefault(),t.createNewPurchaseOrder(e)}}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6 form-group"},[s("label",[t._v("Purchase Order #")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.reference_number,expression:"reference_number"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:t.reference_number},on:{input:function(e){e.target.composing||(t.reference_number=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"col-md-6 form-group"}),t._v(" "),s("div",{staticClass:"col-md-6 form-group"},[s("label",[t._v("Warehouse")]),t._v(" "),s("vue-select",{attrs:{label:"name",options:t.warehouses},on:{input:function(e){t.selectWarehouse()}},model:{value:t.warehouse,callback:function(e){t.warehouse=e},expression:"warehouse"}})],1),t._v(" "),s("div",{staticClass:"col-md-6 form-group"},[s("label",[t._v("Supplier")]),t._v(" "),s("vue-select",{attrs:{label:"person",options:t.contacts},on:{input:function(e){t.selectContact()}},model:{value:t.contact,callback:function(e){t.contact=e},expression:"contact"}})],1)]),t._v(" "),s("br"),t._v(" "),t._m(0),t._v(" "),s("br"),t._v(" "),s("table",{staticClass:"table table-hover table-sm"},[t._m(1),t._v(" "),t._m(2),t._v(" "),s("tbody",[t._l(t.purchase_order_items,function(e,i){return s("tr",{key:i},[s("td",[t._v(t._s(e.item.stock_keeping_unit))]),t._v(" "),s("td",[s("vue-select",{attrs:{label:"name",options:t.items},on:{input:function(e){t.selectItem(i)}},model:{value:e.item,callback:function(s){t.$set(e,"item",s)},expression:"purchase_order_item.item"}})],1),t._v(" "),s("td",[s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.quantity,expression:"purchase_order_item.quantity",modifiers:{number:!0}}],staticClass:"form-control",attrs:{required:""},domProps:{value:e.quantity},on:{input:function(s){s.target.composing||t.$set(e,"quantity",t._n(s.target.value))},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("td",[t._v("\n                                        "+t._s(e.unitOfMeasurement)+"\n                                    ")]),t._v(" "),s("td",[s("vue-select",{attrs:{label:"price",options:e.itemPricelists},on:{input:function(e){t.selectItemPricelist(i)}},model:{value:e.itemPricelist,callback:function(s){t.$set(e,"itemPricelist",s)},expression:"purchase_order_item.itemPricelist"}})],1),t._v(" "),s("td",[t._v(t._s(t._f("Decimal")(e.subTotal)))]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:function(e){t.deleteRow(i)}}},[s("i",{staticClass:"far fa-times-circle"})])])])}),t._v(" "),s("tr",[s("td",{attrs:{colspan:"4"}}),t._v(" "),t._m(3),t._v(" "),s("td",[t._v(t._s(t._f("Decimal")(t.amount)))]),t._v(" "),s("td")])],2)]),t._v(" "),s("div",{staticClass:"pt-3"},[s("button",{staticClass:"btn btn-outline-success btn-sm",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.viewPOs(e)}}},[s("i",{staticClass:"fas fa-chevron-left"}),t._v(" Back")]),t._v(" "),s("button",{staticClass:"btn btn-outline-success btn-sm",attrs:{type:"button"},on:{click:t.addNewItem}},[s("i",{staticClass:"fas fa-plus-circle"}),t._v(" Add New Item")]),t._v(" "),s("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"submit",disabled:t.isDisabled}},[s("i",{staticClass:"fas fa-plus"}),t._v(" Create New Purchase Order")])])])]):s("div",[t._m(4)])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h6",[e("b",[e("u",[this._v("Purchase Order Items")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("caption",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3"})])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v("SKU")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Item Name")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Quantity")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("UOM")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Price")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Amount")]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v("Action")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",[e("b",[this._v("Total")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])}]}},"/0wF":function(t,e,s){var i=s("VU/8")(s("UN6C"),s("+H9S"),!1,function(t){s("kOBL")},null,null);t.exports=i.exports},UN6C:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{ifReady:!1,contacts:[],contact:null,contact_id:"",warehouses:[],warehouse:null,warehouse_id:"",items:[],reference_number:"",purchase_order_items:[{item:"",item_id:"",quantity:0,unitOfMeasurements:[],unitOfMeasurement:"",unit_of_measurement_id:"",itemPricelists:[],itemPricelist:0,item_pricelist_id:"",subTotal:0}],amount:"",isDisabled:!0}},filters:{Decimal:function(t){if(t)return t.toFixed(2)}},mounted:function(){var t=this;this.date=moment(new Date,"DDMMMYYYY").endOf("month").format("YYYY-MM-DD");var e=new Promise(function(e,s){axios.get("/api/contacts/get-all-contacts/").then(function(s){t.contacts=s.data.contacts.filter(function(t){return 2==t.contact_type_id}),e()}).catch(function(t){console.log(t),s()})}),s=new Promise(function(e,s){axios.get("/api/warehouses/get-all-warehouses").then(function(s){t.warehouses=s.data.warehouses,e()}).catch(function(t){console.log(t),s()})}),i=new Promise(function(e,s){axios.get("/api/items/get-all-items-without-components/").then(function(s){t.items=s.data.items,e()}).catch(function(t){console.log(t),s()})});Promise.all([e,s,i]).then(function(){t.ifReady=!0})},computed:{subTotalRow:function(){return this.purchase_order_items.map(function(t){return t.quantity*t.unit_price})},total:function(){return this.purchase_order_items.reduce(function(t,e){return t+e.quantity*e.unit_price},0)}},methods:{viewPOs:function(){this.$router.push({name:"purchase-orders.index"})},selectContact:function(){this.contact_id=this.contact.id},selectWarehouse:function(){this.warehouse_id=this.warehouse.id},selectItem:function(t){var e=this;if(this.purchase_order_items[t].item instanceof Object){this.purchase_order_items[t].item_id=this.purchase_order_items[t].item.id,this.purchase_order_items[t].unitOfMeasurement=this.purchase_order_items[t].item.purchase_unit_of_measurement.name,this.purchase_order_items[t].unit_of_measurement_id=this.purchase_order_items[t].item.purchase_unit_of_measurement.id;new Promise(function(s,i){axios.get("/api/item-pricelists/get-item-pricelists/"+e.purchase_order_items[t].item_id).then(function(i){e.purchase_order_items[t].itemPricelists=i.data.item_pricelists,s()}).catch(function(t){console.log(t),i()})})}},selectItemPricelist:function(t){this.purchase_order_items[t].item instanceof Object&&(this.purchase_order_items[t].item_pricelist_id=this.purchase_order_items[t].itemPricelist.id,this.purchase_order_items[t].subTotal=parseFloat(this.purchase_order_items[t].quantity)*parseFloat(this.purchase_order_items[t].itemPricelist.price),this.updateTotalAmount())},updateTotalAmount:function(){var t=0;this.purchase_order_items.forEach(function(e){t+=e.subTotal}),this.amount=t,this.amount>0?this.isDisabled=!1:this.isDisabled=!0},addNewItem:function(){this.purchase_order_items.push({item:"",item_id:"",quantity:"",unitOfMeasurements:[],unitOfMeasurement:"",unit_of_measurement_id:"",itemPricelists:[],itemPricelist:"",item_pricelist_id:"",subTotal:0}),this.updateTotalAmount()},deleteRow:function(t){this.purchase_order_items.splice(t,1),this.updateTotalAmount()},createNewPurchaseOrder:function(){var t=this;this.ifReady=!1;var e=[];this.purchase_order_items.forEach(function(t){e.push({item_id:t.item_id,quantity:t.quantity,unit_of_measurement_id:t.unit_of_measurement_id,item_pricelist_id:t.item_pricelist_id})});var s={reference_number:this.reference_number,warehouse_id:this.warehouse_id,contact_id:this.contact_id,amount:this.amount,purchase_order_items:e};axios.post("/api/purchase-orders",s).then(function(e){console.log(e.data),t.$router.push({name:"purchase-orders.index"})}).catch(function(e){console.log(e),alert("Error! Can't create purchase order"),t.ifReady=!0})}}}},fuyQ:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,"td{width:100px!important}",""])},kOBL:function(t,e,s){var i=s("fuyQ");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);s("rjj0")("9b702c04",i,!0,{})}});
//# sourceMappingURL=11.js.map