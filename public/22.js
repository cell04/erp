webpackJsonp([22],{KfA8:function(e,t,r){"use strict";function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){var e;return i(e={ifReady:!0,purchaseOrderId:null,purchaseOrder:null,items:[{tracking_number:null,purchase_item_id:null}],contacts:"",sub_departments:"",itemsList:"",reference_number:"",contact_id:"",receive_date:"",sub_department_id:""},"items",[]),i(e,"amount",""),e},mounted:function(){var e=this;this.purchaseOrderId=this.$route.params.po_id;new Promise(function(t,r){axios.get("/api/contacts/retrieve-all-contacts/").then(function(r){console.log(r),e.contacts=r.data.contacts,r.data.response&&t()})}),new Promise(function(t,r){axios.get("/api/sub-departments/retrieve-all-sub-departments/").then(function(r){e.sub_departments=r.body.sub_departments,r.data.response&&t()})}),new Promise(function(t,r){axios.get("/api/purchase-orders/"+e.purchaseOrderId+"/receive").then(function(r){e.purchaseOrder=r.data.purchase_order,e.items=r.data.purchase_order.purchase_items,console.log("items:"+items),r.data&&t()})})},computed:{subtotalRow:function(){return this.items.map(function(e){return Number(e.quantity*e.unit_price)})},total:function(){return this.items.reduce(function(e,t){return e+t.quantity*t.unit_price},0)}},methods:{onSelectItem:function(e,t){var r=t,i=this.itemsList.find(function(t){return t.id===e});console.log(i),this.items[r].sku=i.SKU,this.items[r].item_id=i.id,this.items[r].unit_id=i.purchase_unit_id,this.items[r].unit_name=i.purchase_uom.name,this.items[r].unit_price=i.purchase_price},createNewReceiving:function(){var e=this;console.log("purchase order: "+JSON.stringify(this.purchaseOrder));var t=[];this.$data.items.forEach(function(e){t.push({tracking_number:e.tracking_number,item_id:e.item_id,quantity:e.quantity,unit_id:e.unit_id,purchase_item_id:e.id,unit_price:e.unit_price})});var r={purchase_order_id:this.purchaseOrderId,contact_id:this.purchaseOrder.contact_id,sub_department_id:this.purchaseOrder.sub_department_id,reference_number:this.$data.reference_number,receive_date:this.$data.receive_date,amount:this.total,items:t};console.log(r),axios.post("/api/receive-orders",r).then(function(t){console.log(JSON.stringify(t.data)),alert("Purchase order has been received!"),e.$router.push({name:"receive-orders.index"})}).catch(function(e){console.log(e),alert("Error! Can't receive order")})}}}},"PpM+":function(e,t,r){var i=r("VU/8")(r("KfA8"),r("bBzm"),!1,null,null,null);e.exports=i.exports},bBzm:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[e._v("\n            Purchase Orders / Receivings / New\n        ")]),e._v(" "),r("div",{staticClass:"card-body"},[e.ifReady?r("div",[r("form",{on:{submit:function(t){return t.preventDefault(),e.createNewReceiving(t)}}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Date")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.receive_date,expression:"receive_date"}],staticClass:"form-control",attrs:{type:"date",required:""},domProps:{value:e.receive_date},on:{input:function(t){t.target.composing||(e.receive_date=t.target.value)}}})]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Contact")]),e._v(" "),r("input",{staticClass:"form-control",attrs:{type:"text",disabled:"disabled"},domProps:{value:e.purchaseOrder.contact.company}})]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Warehouse")]),e._v(" "),r("input",{staticClass:"form-control",attrs:{type:"text",disabled:"disabled"},domProps:{value:e.purchaseOrder.sub_department.name}})]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Reference #")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.reference_number,expression:"reference_number"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.reference_number},on:{input:function(t){t.target.composing||(e.reference_number=t.target.value)}}})])]),e._v(" "),r("br"),e._v(" "),r("table",{staticClass:"table table-hover table-sm"},[e._m(0),e._v(" "),e._m(1),e._v(" "),r("tbody",[e._l(e.items,function(t,i,a){return r("tr",{key:t.item.id},[r("td",[e._v(e._s(t.item.SKU))]),e._v(" "),r("td",[e._v("\n                                   "+e._s(t.item.name)+"\n                                ")]),e._v(" "),r("td",[e._v(e._s(t.quantity)+" ")]),e._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model.number",value:t.qty_received,expression:"item.qty_received",modifiers:{number:!0}}],staticClass:"form-control",domProps:{value:t.qty_received},on:{input:function(r){r.target.composing||e.$set(t,"qty_received",e._n(r.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),r("td",[e._v(e._s(t.unit.name))]),e._v(" "),r("td",[e._v(e._s(t.item.unit_price)+" ")]),e._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.tracking_number,expression:"item.tracking_number"}],staticClass:"form-control",attrs:{placeholder:"Tracking #",type:"text"},domProps:{value:t.tracking_number},on:{input:function(r){r.target.composing||e.$set(t,"tracking_number",r.target.value)}}})]),e._v(" "),r("td",[e._v(e._s(e.subtotalRow[i]))])])}),e._v(" "),r("tr",[r("td"),e._v(" "),r("td"),e._v(" "),r("td"),e._v(" "),r("td"),e._v(" "),e._m(2),e._v(" "),r("td",[e._v(e._s(e.total))]),e._v(" "),r("td")])],2)]),e._v(" "),r("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"submit"}},[e._v("Receive")])])]):r("div",[e._m(3)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("caption",[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-3"})])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[e._v("SKU")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Name")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Ordered Qty")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Qty Received")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("UOM")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Unit Price")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Tracking #")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Amount")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Action")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("b",[this._v("Total")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"progress"},[t("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])}]}}});
//# sourceMappingURL=22.js.map