webpackJsonp([44],{"1+mZ":function(e,t,r){var i=r("VU/8")(r("s48/"),r("ywRJ"),!1,null,null,null);e.exports=i.exports},"s48/":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{ifReady:!0,receivedOrders:[],receivedOrder:null,received_order_id:"",contacts:"",sub_departments:"",itemsList:"",reference_number:"",contact_id:"",order_date:"",sub_department_id:"",items:[],amount:"",paymentTerm:[],paymentTerm_id:"",receivedOrderItems:[]}},mounted:function(){var e=this;new Promise(function(t,r){axios.get("/api/receive-orders/retrieve-all-receive-orders").then(function(r){console.log(r.data.receive_orders),e.receivedOrders=r.data.receive_orders,r.data.response&&t()})}),new Promise(function(t,r){axios.get("/api/contacts/retrieve-all-contacts").then(function(r){e.contacts=r.data.contacts,r.data.response&&t()})}),new Promise(function(t,r){axios.get("/api/sub-departments/retrieve-all-sub-departments/").then(function(r){e.sub_departments=r.data.sub_departments,r.data.response&&t()})}),new Promise(function(t,r){axios.get("/api/payment-terms/retrieve-all-payment-terms").then(function(r){e.paymentTerm=r.data.payment_terms,r.data.response&&t()})}),this.addRow()},computed:{subtotalRow:function(){return this.items.map(function(e){return Number(e.quantity*e.unit_price)})},total:function(){return this.items.reduce(function(e,t){return e+t.quantity*t.unit_price},0)}},methods:{selectReceivedOrder:function(){var e=this;this.received_order_id=this.receivedOrder.id,axios.get("/api/receive-orders/"+this.receivedOrder.id).then(function(t){e.items=t.data.purchase_order.receive_items,t.data.response&&resolve()})},onSelectItem:function(e,t){var r=t,i=this.itemsList.find(function(t){return t.id===e});this.items[r].sku=i.SKU,this.items[r].item_id=i.id,this.items[r].unit_id=i.purchase_unit_id,this.items[r].unit_name=i.purchase_uom.name,this.items[r].unit_price=i.purchase_price},addRow:function(){this.items.push({sku:"",item_id:"",quantity:"",unit_id:"",unit_name:"",unit_price:""})},deleteRow:function(e){this.items.splice(e,1)},createNewPurchaseOrder:function(){var e=this,t=[];this.$data.items.forEach(function(r){t.push({item_id:r.item_id,quantity:r.quantity,unit_id:r.unit_id,unit_price:r.unit_price,receive_order_id:e.$data.received_order_id})});var r={reference_number:this.$data.reference_number,contact_id:this.$data.contact_id,order_date:this.$data.order_date,sub_department_id:this.$data.sub_department_id,payment_term_id:this.$data.paymentTerm_id,amount:this.total,items:t,receive_order_id:this.$data.received_order_id};axios.post("/api/bills",r).then(function(t){e.$router.push({name:"bills.index"})}).catch(function(e){console.log(e),alert("Error! Can't create Bill")})}}}},ywRJ:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header"},[e._v("\n            Bills / Create New Bill\n        ")]),e._v(" "),r("div",{staticClass:"card-body"},[e.ifReady?r("div",[r("form",{on:{submit:function(t){return t.preventDefault(),e.createNewPurchaseOrder(t)}}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12 form-group"},[r("label",[e._v("Received Orders")]),e._v(" "),r("vue-select",{attrs:{label:"reference_number",options:e.receivedOrders,required:""},on:{input:function(t){e.selectReceivedOrder()}},model:{value:e.receivedOrder,callback:function(t){e.receivedOrder=t},expression:"receivedOrder"}})],1),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Date")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.order_date,expression:"order_date"}],staticClass:"form-control",attrs:{type:"date",required:""},domProps:{value:e.order_date},on:{input:function(t){t.target.composing||(e.order_date=t.target.value)}}})]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Contact")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.contact_id,expression:"contact_id"}],staticClass:"form-control",attrs:{required:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.contact_id=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"",disabled:"",hidden:""}},[e._v("Select Contact")]),e._v(" "),e._l(e.contacts,function(t){return r("option",{domProps:{value:t.id}},[e._v(e._s(t.person))])})],2)]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Warehouse")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.sub_department_id,expression:"sub_department_id"}],staticClass:"form-control",attrs:{required:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.sub_department_id=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"",disabled:"",hidden:""}},[e._v("Select Warehouse")]),e._v(" "),e._l(e.sub_departments,function(t){return r("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])})],2)]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Payment Term")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.paymentTerm_id,expression:"paymentTerm_id"}],staticClass:"form-control",attrs:{required:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.paymentTerm_id=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"",disabled:"",hidden:""}},[e._v("Select Payment Term")]),e._v(" "),e._l(e.paymentTerm,function(t){return r("option",{domProps:{value:t.id}},[e._v(e._s(t.name))])})],2)]),e._v(" "),r("div",{staticClass:"col-md-6 form-group"},[r("label",[e._v("Reference #")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.reference_number,expression:"reference_number"}],staticClass:"form-control",attrs:{type:"text",required:""},domProps:{value:e.reference_number},on:{input:function(t){t.target.composing||(e.reference_number=t.target.value)}}})])]),e._v(" "),r("br"),e._v(" "),r("table",{staticClass:"table table-hover table-sm"},[e._m(0),e._v(" "),e._m(1),e._v(" "),r("tbody",[e._l(e.items,function(t){return r("tr",[r("td",[e._v(e._s(t.item.sku))]),e._v(" "),r("td",[r("select",{directives:[{name:"model",rawName:"v-model",value:t.item.item_id,expression:"item.item.item_id"}],staticClass:"form-control",attrs:{required:""},on:{change:[function(r){var i=Array.prototype.filter.call(r.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(t.item,"item_id",r.target.multiple?i:i[0])},function(r){e.onSelectItem(t.item.item_id,e.key)}]}},[r("option",{attrs:{value:"",disabled:"",hidden:""}},[e._v("Select Item")]),e._v(" "),e._l(e.itemsList,function(t){return r("option",{domProps:{value:t.item.id}},[e._v(e._s(t.item.name))])})],2)]),e._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model.number",value:t.item.quantity,expression:"item.item.quantity",modifiers:{number:!0}}],staticClass:"form-control",attrs:{required:""},domProps:{value:t.item.quantity},on:{input:function(r){r.target.composing||e.$set(t.item,"quantity",e._n(r.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),r("td",[e._v(e._s(t.item.unit_name))]),e._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model.number",value:t.item.unit_price,expression:"item.item.unit_price",modifiers:{number:!0}}],staticClass:"form-control",domProps:{value:t.item.unit_price},on:{input:function(r){r.target.composing||e.$set(t.item,"unit_price",e._n(r.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),r("td",[e._v(e._s(e.subtotalRow[e.key]))]),e._v(" "),r("td",[r("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:e.deleteRow}},[e._v("Remove")])])])}),e._v(" "),r("tr",[r("td"),e._v(" "),r("td"),e._v(" "),r("td"),e._v(" "),r("td"),e._v(" "),e._m(2),e._v(" "),r("td",[e._v(e._s(e.total))]),e._v(" "),r("td")])],2),e._v(" "),r("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button"},on:{click:e.addRow}},[e._v("Add Row")])]),e._v(" "),r("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"submit"}},[e._v("Create New Bill")])])]):r("div",[e._m(3)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("caption",[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-3"})])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("thead",[r("tr",[r("th",{attrs:{scope:"col"}},[e._v("SKU")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Name")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Quantity")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("UOM")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Unit Price")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Amount")]),e._v(" "),r("th",{attrs:{scope:"col"}},[e._v("Action")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("b",[this._v("Total")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"progress"},[t("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",staticStyle:{width:"100%"},attrs:{role:"progressbar","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"}})])}]}}});
//# sourceMappingURL=44.js.map